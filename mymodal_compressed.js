/*
* MyModal
* version: 0.0.1
* Date: 05/06/2013
* author: santiago chen
* email: santiago1209@foxmail.com
* more on https://github.com/santiagochen
*
* MyModal
* It is a Javascript Popup Modal Plugin. 
* Tested Browser: Firefox, Chrome, Safari, IE6-IE9.
*
* MyModal.modal({
* 		target: target/content is Required. Dom Selector: Identifier for domElement in page.it has higher priority than content.
* 		content: target/content is Required. String: Html Element.
* 		isdrag: Optional. Boolean: false as default. Decide whether it is permitted to dragged.
* 		overlayclose: Optional. Boolean: false as default. Decide whether it is permitted to close modal by click on somewhere else.
*		overlayalpha: Optional. Number: 0.1 is default;
*		zdepth: Optional. Number: 9999 is default.
* 		onclose: Optional. Function: eventHandler for close event.
* 		onopen: Optional. Function: eventHandler for open event.
*	})
* 
* MyModal.close()
*/
var MyModal=MyModal||{};(function(e){var t,n,r=!1,i=!1,s=!1,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;MyModal.modal=function(e){t=e.target||null,n=e.content||null,r=e.isdrag||!1,o=e.overlayalpha||.1,s=e.overlayclose||!1,u=e.zdepth||9999,f=e.onopen||null,a=e.onclose||null,l=E(t,n);if(l==null)throw"no elements in modal is found";S(l)},MyModal.close=function(){T()};var E=function(e,t){if(e!==null)return e.innerHTML;if(e==null)return t!==null?t:null},S=function(e){c=C.modal(),c.innerHTML=e,h=C.dragbar(),w=C.inwrap(),g=C.modalclose(),w.appendChild(c),b=C.wrap(),b.appendChild(g),b.appendChild(h),b.appendChild(w),y=C.overlay(),x()},x=function(){document.body.appendChild(y),document.body.appendChild(b);var t=b.getBoundingClientRect().width||b.clientWidth,n=b.getBoundingClientRect().height||b.clientHeight,i=document.documentElement.clientWidth,s=document.documentElement.clientHeight,o=k().x,u=k().y;L()==1?(b.style.left=(i-t)/2+o+"px",b.style.top=(s-n)/2+u+"px"):(b.style.left=(i-t)/2+"px",b.style.top=(s-n)/2+"px"),v=navigator.userAgent.indexOf("MSIE")>=0?parseInt(b.currentStyle.left):e.getComputedStyle(b).left,m=navigator.userAgent.indexOf("MSIE")>=0?parseInt(b.currentStyle.top):e.getComputedStyle(b).top,e.onscroll=function(){t=b.getBoundingClientRect().width||b.clientWidth,n=b.getBoundingClientRect().height||b.clientHeight,i=document.documentElement.clientWidth,s=document.documentElement.clientHeight,o=k().x,u=k().y,r==1?L()==1?(b.style.left=v+o+"px",b.style.top=m+u+"px"):(b.style.left=v+"px",b.style.top=m+"px"):L()==1?(b.style.left=(i-t)/2+o+"px",b.style.top=(s-n)/2+u+"px"):(b.style.left=(i-t)/2+"px",b.style.top=(s-n)/2+"px")},e.onresize=function(){t=b.getBoundingClientRect().width||b.clientWidth,n=b.getBoundingClientRect().height||b.clientHeight,i=document.documentElement.clientWidth,s=document.documentElement.clientHeight,o=k().x,u=k().y,r==1?L()==1?(b.style.left=v+o+"px",b.style.top=m+u+"px"):(b.style.left=v+"px",b.style.top=m+"px"):L()==1?(b.style.left=(i-t)/2+o+"px",b.style.top=(s-n)/2+u+"px"):(b.style.left=(i-t)/2+"px",b.style.top=(s-n)/2+"px")},N(),f!==null&&f()},T=function(){document.body.removeChild(b),document.body.removeChild(y),a!==null&&a()},N=function(){g.onclick=function(){T()},s==1&&(y.onclick=function(){T()}),r==1&&(h.style.cursor="move",document.body.onmousemove=function(t){if(i==1){h.style.cursor="move";var n=t||e.event;b.style.left=n.clientX-p+"px",b.style.top=n.clientY-d+"px"}}),h.onmousedown=function(t){var n=t||e.event;i=!0,p=parseInt(n.clientX)-parseInt(b.style.left),d=parseInt(n.clientY)-parseInt(b.style.top)},document.documentElement.onmouseup=function(t){var n=t||e.event;i=!1,v=navigator.userAgent.indexOf("MSIE")>=0?parseInt(b.currentStyle.left):e.getComputedStyle(b).left,m=navigator.userAgent.indexOf("MSIE")>=0?parseInt(b.currentStyle.top):e.getComputedStyle(b).top}},C={overlay:function(){var e=document.createElement("div");return e.style.display="block",e.style.opacity=o,e.style.filter="alpha(opacity="+o*100+")",e.style.backgroundColor="#000000",e.style.width=document.body.clientWidth+"px",e.style.height=document.body.clientHeight+"px",e.style.position=L()==1?"absolute":"fixed",e.style.top="0px",e.style.left="0px",e.style.zIndex=u-1,e.id="mymodal-overlay",e},modal:function(){var e=document.createElement("div");return e.style.display="block",e.style.margin="0",e.id="mymodal",e},dragbar:function(){var e=document.createElement("div");return e.style.display="block",e.style.height="15px",e.style.width="100%",e.style.margin="0",e.id="mymodal-dragbar",e},inwrap:function(){var e=document.createElement("div");return e.style.display="block",e.style.margin="0 5px 5px 5px",e.id="mymodal-inwrap",e},wrap:function(){var e=document.createElement("div");return e.style.display="block",e.style.borderStyle="solid",e.style.borderWidth="2px",e.style.position=L()==1?"absolute":"fixed",e.style.zIndex=u,e.id="mymodal-wrap",e},modalclose:function(){var e=document.createElement("a");return e.style.display="block",e.style.position="absolute",e.style.cursor="pointer",e.style.color="#ffffff",e.innerHTML="x",e.id="mymodal-close",e}},k=function(){var t={};return e.navigator.appName.indexOf("Microsoft Internet Explorer")>=0?(t.x=document.documentElement.scrollLeft,t.y=document.documentElement.scrollTop):e.navigator.userAgent.indexOf("Firefox")>=0?(t.x=document.documentElement.scrollLeft,t.y=document.documentElement.scrollTop):(t.x=document.body.scrollLeft,t.y=document.body.scrollTop),t},L=function(){return e.navigator.userAgent.indexOf("MSIE 6.0")>=0?!0:!1}})(window)